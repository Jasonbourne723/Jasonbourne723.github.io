---
title: 数据结构与算法：递归
date: 2023-01-03 10:12:00 +0800
categories: [4.数据结构与算法]
tags: [数据结构与算法]
---

## 如何理解递归

递归是一种应用非常广泛的算法（或者编程技巧），很多数据结构和算法的编码实现都要用到递归。举个生活中用到递归的例子，周末你带着女朋友去电影院看电影，女朋友问你，咱们现在坐在第几排啊？电影院里面太黑了，看不清，没法数，现在你怎么办？别忘了你是程序员，这个可难不倒你，递归就开始排上用场了。于是你就问前面一排的人他是第几排，你想只要在他的数字上加一，就知道自己在哪一排了。但是，前面的人也看不清啊，所以他也问他前面的人。就这样一排一排往前问，直到问到第一排的人，说我在第一排，然后再这样一排一排再把数字传回来。直到你前面的人告诉你他在哪一排，于是你就知道答案了。这就是一个非常标准的递归求解问题的分解过程，去的过程叫“递”，回来的过程叫“归”。基本上，所有的递归问题都可以用递推公式来表示。刚刚这个生活中的例子，我们用递推公式将它表示出来就是这样的：f(n)=f(n-1)+1 其中，f(1)=1

### 递归需要满足的三个条件

1. 一个问题的解可以分解为几个子问题的解何为子问题？子问题就是数据规模更小的问题。比如，前面讲的电影院的例子，你要知道，“自己在哪一排”的问题，可以分解为“前一排的人在哪一排”这样一个子问题。
2. 这个问题与分解之后的子问题，除了数据规模不同，求解思路完全一样比如电影院那个例子，你求解“自己在哪一排”的思路，和前面一排人求解“自己在哪一排”的思路，是一模一样的。
3. 存在递归终止条件把问题分解为子问题，把子问题再分解为子子问题，一层一层分解下去，不能存在无限循环，这就需要有终止条件。还是电影院的例子，第一排的人不需要再继续询问任何人，就知道自己在哪一排，也就是 f(1)=1，这就是递归的终止条件。

## 如何编写递归代码

写递归代码的关键就是找到如何将大问题分解为小问题的规律，并且基于此写出递推公式，然后再推敲终止条件，最后将递推公式和终止条件翻译成代码。

### 注意事项

- 递归代码要警惕堆栈溢出(递归深度)
- 递归代码要警惕重复计算(可以用散列表保存计算结果)

### 代码示例

#### 反转字符串

```
public string reverseStr(string str)
{
    if (str.Length == 1) return str;
    return str[str.Length - 1] + reverseStr(str.Substring(0, str.Length - 1));
}
```

#### 求阶乘

```
public long Factorial(long n)
{
    if (n == 1) return 1;
    return n * Factorial(n - 1);
}
```

#### 斐波那契数列(使用散列表避免重复计算)

```
Dictionary<long, long> dic = new Dictionary<long, long>();
public long Fibonacci(long length)
{

    if (length <= 2)
    {
        Console.Write(1 + " ");
        return 1;
    }

    long a1;
    if (dic.TryGetValue(length - 1, out var value))
    {
        a1 = value;
    }
    else
    {
        a1 = Fibonacci(length - 1);
        dic.Add(length - 1, a1);
    }
    long a2;
    if (dic.TryGetValue(length - 2, out var value1))
    {
        a2 = value1;
    }
    else
    {
        a2 = Fibonacci(length - 2);
        dic.Add(length - 2, a2);
    }
    var res = a1 + a2;
    Console.Write(res + " ");
    return res;
}
```