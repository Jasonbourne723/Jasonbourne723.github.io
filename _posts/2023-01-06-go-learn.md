---
title: Go语言学习笔记
date: 2023-01-06 01:12:00 +0800
pin: true 
categories: [编程语言]
tags: [Go]
---

# Go基础

## 简介

### Go语言主要特征

1. 自动立即回收。
2. 更丰富的内置类型。
3. 函数多返回值。
4. 错误处理。
5. 匿名函数和闭包。
6. 类型和接口。
7. 并发编程。
8. 反射。
9. 语言交互性。

### 25个关键字

``` go
go          break       switch      case    select
package     import      func        if      else
const       type        interface   struct  map
range       chan        defer       default   for    
return      goto        continue    fallthrough  var 
```

### 37个保留字

``` go
Constants:  nil   true       false       iota   
Types:      byte rune bool string error
            int int8 int16 int32 int64 
            uint uint8 uint16 uint32 uint64 uintptr
            complex64 complex128 float32 float64
Funcs:      append delete cap len make new close 
            panic recover copy complex real imag
```

### 可见性

1. 声明在函数内部，仅函数内可见。
2. 声明在函数外部，当前包内可见。
3. 声明在函数外部，并且首字母大写，所有包都可见。

## 内置类型

### 值类型

``` go
bool
int int8 int16 int32 int64
uint uint8 uint16 uint32 uint64
float32 float64
complex64 complex128
array
string
```

### 引用类型

```go
slice chan map
```

### 内置函数

```go
append              -- 用来追加元素到数组、slice中,返回修改后的数组、slice
close               -- 主要用来关闭channel
delete              -- 从map中删除key对应的value
panic               -- 停止常规的goroutine  （panic和recover：用来做错误处理）
recover             -- 允许程序定义goroutine的panic动作
imag                -- 返回complex的实部   （complex、real imag：用于创建和操作复数）
real                -- 返回complex的虚部
make                -- 用来分配内存，返回Type本身(只能应用于slice, map, channel)
new                 -- 用来分配内存，主要用来分配值类型，比如int、struct。返回指向Type的指针
cap                 -- capacity是容量的意思，用于返回某个类型的最大容量（只能用于切片和 map）
copy                -- 用于复制和连接slice，返回复制的数目
len                 -- 来求长度，比如string、array、slice、map、channel ，返回长度
print、println      -- 底层打印函数，在部署环境中建议使用 fmt 包
```

### 内置接口

``` go
type error interface {
    Error() string
}
```

## init函数和main函数

### init函数

Go语言中init函数用于包的初始化，有着以下特征：

1. init函数是用于程序执行前做包的初始化的函数，比如初始化包里的变量等
2. 每个包可以拥有多个init函数
3. 包的每个源文件也可以拥有多个init函数
4. 同一个包中多个init函数的执行顺序go语言没有明确的定义(说明)
5. 不同包的init函数按照包导入的依赖关系决定该初始化函数的执行顺序
6. init函数不能被其他函数调用，而是在main函数执行之前，自动被调用

### mian函数

main函数是Go语言程序的默认入口函数（主函数）。
```go
    func main(){
        //函数体
    }
```

### init函数与main函数的异同

相同点：
- 两个函数在定义时不能有任何的参数和返回值，且Go程序自动调用。

不同点：
- init可以应用于任意包中，且可以重复定义多个。
- main函数只能定义在main包中，且只能定义一个。

## 下划线

`_`是特殊标识符，用于忽略结果，它有以下两个作用：

1. 在`import`包时使用，可以调用包的init函数，但不导入包。
2. 将函数返回值赋值给`_`,表示忽略此变量，如果用变量的话，不使用，编译器是会报错的。

## 变量与常量

Go语言中的变量需要声明后才能使用，同一作用域内不支持重复声明。并且Go语言的变量声明后必须使用。

### 声明变量的几种方式

标准声明
```go
var 变量名 变量类型
```
批量声明
```go
var {
    a string
    b int
    c bool
}
```
### 变量初始化

Go语言在声明变量的时候，会自动对变量对应的内存区域进行初始化操作。每个变量会被初始化成其类型的默认值，例如： 整型和浮点型变量的默认值为0。 字符串变量的默认值为空字符串。 布尔型变量默认为false。 切片、函数、指针变量的默认为nil。

标准初始化
```go
var a string = "hello world"
```
一次初始化多个变量
```go
# 编译器会根据等号右边的值来推导变量的类型完成初始化
var a,b = "hello","world"
```
在函数内部，可以使用更简略的 := 方式声明并初始化变量。
```go
package main

import "fmt"

var m = 100

func main() {
    a := 5
    fmt.Println(a,m)
}
```
匿名变量 `_` ,匿名变量不占用命名空间，不会分配内存，所以匿名变量之间不存在重复声明。
```go
func foo() (int, string) {
    return 10, "Q1mi"
}
func main() {
    x, _ := foo()
    _, y := foo()
    fmt.Println("x=", x)
    fmt.Println("y=", y)
}
```

### 常量

相对于变量，常量是恒定不变的值，多用于定义程序运行期间不会改变的那些值。 常量的声明和变量声明非常类似，只是把var换成了const，常量在定义的时候必须赋值。

标准声明
```go
const pi = 3.1415
const e = 2.7182
```
批量声明
```go
const {
    pi = 3.1415
    e = 2.7182
}
```
const同时声明多个常量时，如果省略了值则表示和上面一行的值相同。
```go
const (
    n1 = 100
    n2
    n3
)
```

#### iota 

iota是go语言的常量计数器，只能在常量的表达式中使用。 iota在const关键字出现时将被重置为0。const中每新增一行常量声明将使iota计数一次(iota可理解为const语句块中的行索引)。 使用iota能简化定义，在定义枚举时很有用。

标准例子
```go
const (
    n1 = iota //0
    n2        //1
    n3        //2
    n4        //3
)
```
使用_跳过某些值
```go
const (
    n1 = iota //0
    n2        //1
    _
    n4        //3
)
```
iota声明中间插队
```go
const (
    n1 = iota //0
    n2 = 100  //100
    n3 = iota //2
    n4        //3
)
const n5 = iota //0
```
定义数量级
```go
const (
    _  = iota
    KB = 1 << (10 * iota)
    MB = 1 << (10 * iota)
    GB = 1 << (10 * iota)
    TB = 1 << (10 * iota)
    PB = 1 << (10 * iota)
)
```
多个iota定义在一行
```go
const (
    a, b = iota + 1, iota + 2 //1,2
    c, d                      //2,3
    e, f                      //3,4
)
```

## 基本类型

### 整型

整型分为以下两个大类： 按长度分为：int8、int16、int32、int64对应的无符号整型：uint8、uint16、uint32、uint64。其中，uint8就是我们熟知的byte型，int16对应C语言中的short型，int64对应C语言中的long型。

### 浮点型

Go语言支持两种浮点型数：float32和float64。这两种浮点型数据格式遵循IEEE 754标准： float32 的浮点数的最大范围约为3.4e38，可以使用常量定义：math.MaxFloat32。 float64 的浮点数的最大范围约为 1.8e308，可以使用一个常量定义：math.MaxFloat64。

### 复数

complex64和complex128
复数有实部和虚部，complex64的实部和虚部为32位，complex128的实部和虚部为64位。

### 布尔值

Go语言中以bool类型进行声明布尔型数据，布尔型数据只有true（真）和false（假）两个值。

注意：

- 布尔类型变量的默认值为false。
- Go 语言中不允许将整型强制转换为布尔型.
- 布尔型无法参与数值运算，也无法与其他类型进行转换。

### 字符串

Go语言中的字符串以原生数据类型出现，使用字符串就像使用其他原生数据类型（int、bool、float32、float64 等）一样。 Go 语言里的字符串的内部实现使用UTF-8编码。 字符串的值为双引号(")中的内容，可以在Go语言的源码中直接添加非ASCII码字符。

多行字符串，反引号间换行将被作为字符串中的换行，但是所有的转义字符均无效，文本将会原样输出。
```
s1 := `第一行
第二行
第三行
`
fmt.Println(s1)
```

#### 字符串的常用操作

|方法|介绍|
|--|--|
|len(str)	                                |求长度|
|+或fmt.Sprintf	                            |拼接字符串|
|strings.Split	                            |分割|
|strings.Contains	                        |判断是否包含|
|strings.HasPrefix,strings.HasSuffix	    |前缀/后缀判断|
|strings.Index(),strings.LastIndex()	    |子串出现的位置|
|strings.Join(a[]string, sep string)	    |join操作|